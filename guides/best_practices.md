# Best Practices for W4118

As TAs of the course, we see lots of mistakes all the time, and they are a
perfectly normal part of the learning process.

However, not all mistakes are the valuable, learning-opportunity type; unlike
general implementation mistakes, some tend to have a much larger impact on your
score than they should or deserve. That said, this is not a list of those;
talking about them excessively will just reinforces your memory of the wrong
things. Instead we talk about some of what you _should_ do.

You can use this as a global checklist or list of best practices.

## Course Logistics

### Look for Teammates in Office Hours You Frequent

If someone else shows up in the same office hours you do, then they

- Have similar work initiative as you do
- Have compatible schedule slots to yours

...probably.

### Email the w4118 List For Course Related Requests

Direct emails might not be promptly responded to if, for instance, you ask about
something that is not normally taken care of by the specific TA you contacted.
TAs don't all have the same context to everything within the course.

### Take the Attendance Quiz Diligently

...or you might lose video-recording access. This is _not_ fun if you are under
the required attendance ratio but there are no more lectures to make up from at
the end of the semester: you _will_ not regain access.

Even if you are gonna miss some classes, having a buffer is always good.

### AI/LLM Usage

Baseline: _if you are unsure about anything at all, cite it._

To be very clear: if you _do_ get the AI to do your actual coding work, and you
properly cite it in your references file:

- You will _not_ be in trouble in terms of academic honesty.
- **BUT** you will also not receive credit for the work, since it's not yours.

As such, you should _always_ cite such usages, and you should also always try
work out the issues by yourself.

If your code has AI-autocompletion, you should include in your reference files
the context where it autocompleted any code that you are not already going to
type exactly anyway. Mention the context and your intent with the code logic,
and then the code generated by AI.

When you share your AI chat history, we also much prefer that you submit the
full log as is, instead of pasting the URLs to the chats, which can go all sorts
of wrong and takes more time to verify.

### Edstem

If your question does not directly reveal your specific implementation, but you
also like some anonymity, please prefer to post your question publicly but ask
it anonymously (Edstem allows this), so that more people can potentially benefit
from it. More often than not, the "particular weird thing" that you are facing
is not unique and others are suffering from it too.

## Development

### Make Sure Your Code Compiles by Deadline

Before the deadline, someone _who has been clearly designated_ within the team
should take the time to verify that your kernel compiles. No one should push
after this commit without this person signing off.

Nothing else matters as much as this.

### Start Early

Not much to say about this. I assure you the two weeks allocated are never an
excess.

### Make Lots of Small Commits

Some thing we frequently mention in class is to make tiny, incremental changes.
This makes each change that much more easy to isolate and, if needs be, to
revert. Larger commits are harder to review, harder to merge, harder to
understand when you come back to your short commit message, and if you have too
few commits in a team project, we will also be hard-pressed to recognize your
coding contribution.

This is not saying not to write lots of code at once -- rather, just commit more
often. For instance, you can always make a lot of local commits, many of which
not necessarily working or even compiling, as long as you make sure that when
you _do_ push to main, you have something that is sound.

### Keep `main` Functional

Most homeworks are a group effort, and as a general recommendtation, try to make
it so that if you push something to `main`, that commit is properly tested _or_
you make any issue within known to your teammates -- it should at the very least
_compile_.

Granted, there are lots of different possible team dynamics, but this is
something we believe to be sound. We are not saying you always need proper PRs
and code reviews, since sometimes they do slow down development, but keeping
commit hygiene is good.

### Enter Feature-Freeze Hours Before Deadline

Large companies enter code-freeze before holidays to avoid the risk of pushing
something bad and then causing poor oncalls to have to get away from festivities
and get on conference calls. Once you are very near the deadline of a homework
submission, we recommend you hold off any significant code change efforts. Many
homeworks require thorough testing to get right, and regression is always a
risk. If you have a sudden realization in the final hour before the deadline
that you made a mistake, slow down, stop, hold the thought.

Almost every semester we have students who make bad last minute pushes that
don't compile, that mess something up, or otherwise cause more harm than good to
their homework.

### Maintain an Automated Test Suite

If you notice yourself doing the same couple of things to verify that your code
is working after each recompilation, consider making that a test suite -- some
shell script, potentially even ChatGPT'ed, whatever, just cite it properly.

Now obviously if we ask you to write some tester program as a deliverable, then
you should do it. But you are not limited to it, and whenever your test
procedure involves not just the program itself, but a full process, having some
sort of script will greatly improve the testing process. Not only does it save
your manual typing time, it also serves to make the process _consistent_,
preventing cases where you get the wrong impression because you neglected a
step, or are testing against a previous kernel version.

You don't have to create a full CI/CD pipeline, but it would be really _cool_.

And overkill. But cool.

## Unofficial Tools

Use at your own risk. These tooling suggestions will not be supported officially
by the teaching staff. Think of them as extra-curricular tech.

### Use `clang-format`

The `linux` repo in most homeworks comes with a `.clang-format` file hidden in
the root directory. This file will allow the very relevantly named
`clang-format` tool (`sudo apt install clang-format`) to format your code to the
spec that is expected in the Linux repo, and help avoid many of the issues that
`checkpatch` looks for.

_HOWEVER_, it should be noted that if you just use it directly on existing linux
source files, it might format irrelevant stuff to your own, and possibly
introduce some degree of messiness. It should be fine for brand new files that
you are adding though.

### Pre-commit

For the even lazier: add it as a [pre-commit](https://pre-commit.ci/).

```yaml
repos:
  - repo: https://github.com/pre-commit/mirrors-clang-format
    rev: v14.0.6
    hooks:
      - id: clang-format
```

### QEMU

See [the actual QEMU guide](./qemu.md).
